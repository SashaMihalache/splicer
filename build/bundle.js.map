{"version":3,"file":"bundle.js","sources":["../src/splicer/buffer-loader.js","../src/splicer/engine.js","../src/main.js"],"sourcesContent":["class BufferLoader {\n  constructor(context, urlList) {\n    this.context = context;\n    this.urlList = urlList;\n  }\n\n  async loadAllBuffers() {\n    return new Promise(resolve => {\n\n      const promises = [];\n      for (let i = 0; i < this.urlList.length; ++i) {\n        const singlePromise = this.loadBuffer(this.urlList[i], i)\n        promises.push(singlePromise);\n      }\n\n      Promise.all(promises).then((bufferList) => {\n        resolve(bufferList);\n      })\n    })\n  }\n\n  loadBuffer(url, index) {\n    return new Promise((resolve, reject) => {\n      fetch(url)\n        .then(body => {\n\n          body.arrayBuffer()\n            .then(buffer => {\n\n              this.context.decodeAudioData(buffer, (audio) => {\n                if (!audio) alert('Error decoding file data: ' + url);\n\n                resolve(audio);\n              })\n            })\n            .catch(err => console.log('Error buffering', err));\n        })\n        .catch(err => {\n          alert('Buffer Loader : Fetch Error');\n        })\n    });\n  }\n\n}\n\nexport default BufferLoader;","import BufferLoader from './buffer-loader';\n\nclass Engine {\n  constructor(tempo, sequenceMatrix) {\n    this.tempo = tempo;\n    this.sequenceMatrix = sequenceMatrix;\n    this.context = null;\n    this.trackList = [];\n  }\n\n  async init() {\n    try {\n      this.context = new AudioContext();\n    }\n    catch (e) {\n      alert(\"Web Audio API is not supported in this browser\", e);\n    }\n\n    const sampleListURL = Object.keys(this.sequenceMatrix);\n    const bufferLoader = new BufferLoader(this.context, sampleListURL);\n    const bufferList = await bufferLoader.loadAllBuffers();\n    this.trackList = this.createTrackChannels(bufferList);\n  }\n\n  createTrackChannels(bufferList) {\n    const trackList = []\n\n    bufferList.forEach(audio => {\n      const track = this.context.createBufferSource();\n      track.buffer = audio;\n      track.connect(this.context.destination);\n      trackList.push(track);\n    })\n\n    return trackList;\n  }\n\n  playPattern() {\n    const sixteenthNoteTime = (this.tempo / 60) / 32;\n    const matrixKeys = Object.keys(this.sequenceMatrix);\n    const matrixValues = matrixKeys.map(key => this.sequenceMatrix[key]);\n    const LEN = matrixValues[0].length;\n    let time = this.context.currentTime;\n\n    for (let sixteenthBeat = 0; sixteenthBeat < LEN; sixteenthBeat++) {\n      for (let trackIndex = 0; trackIndex < matrixKeys.length; trackIndex++) {\n        const currentValue = matrixValues[trackIndex][sixteenthBeat];\n        if (currentValue === 'x') {\n          this.playSound(this.trackList[trackIndex], time);\n        }\n      }\n\n      time += sixteenthNoteTime;\n    }\n  }\n\n  playSound(sample, time) {\n    const source = this.context.createBufferSource();\n    source.buffer = sample.buffer;\n    source.connect(this.context.destination);\n    source.start(time);\n  }\n}\n\nexport default Engine;\n\n  // pattern 8th\n  // 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\n  // k x   -   -   -   x   -   -   - \n  // s -   -   x   -   -   -   x   -\n  // h x   x   x   x   x   x   x   x\n\n  // k x - - - - - - - x - - - - - - - \n  // s - - - - x - - - - - - - x - - -\n  // h x - x - x - x - x - x - x - x -\n  // pattern 16th\n  // <------------------------------> measure (1 measure = 4 beats = 8 8ths notes)\n  // <------><------><------><------> beat (1beat = 4 8th notes)\n  // <><><><><><><><><><><><><><><><> 8th\n\n  // 1 measure = 16 sixteenth notes","import './styles.scss';\nimport Engine from './splicer/engine';\n\nconst playButton = document.querySelector('button');\nconst sequenceMatrix = {\n  \"src/audio/kick.wav\": ['x', '-', '-', '-', '-', '-', '-', '-', 'x', '-', '-', '-', '-', '-', '-', '-'],\n  \"src/audio/snare.wav\": ['-', '-', '-', '-', '-', '-', '-', '-', 'x', '-', '-', '-', '-', '-', '-', '-'],\n  \"src/audio/hihat.wav\": ['-', '-', '-', '-', 'x', '-', '-', '-', 'x', '-', 'x', '-', 'x', '-', 'x', '-'],\n}\n\nplayButton.addEventListener('click', handlePlayClick);\n\nconst SplicerEngine = new Engine(120, sequenceMatrix);\nSplicerEngine.init();\n\nfunction handlePlayClick() {\n  this.innerHTML = '&#9616;&nbsp;&#9612;'\n  SplicerEngine.playPattern();\n}"],"names":[],"mappings":"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"}